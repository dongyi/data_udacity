A/B 测试最终项目
=========================


度量选择
-------------

* cookie数量: 不变度量。
  我们改变“开始免费试学”页面的时候，访问网站的用户数量不会发生变化。因为他们在看到这个页面之前已经访问了网站，所以这是个不变指标

* user-ids数量: 不是不变度量也不是评估度量。
  因为注册数量可能依赖是否点击“开始免费试学”页面。所以不是一个不变指标。另外，这个指标可能与其他指标有一定的相关性，而且注册数量可能随着时间波动，比如某一天特别多，可能影响我们的测量。更适合的指标应该是一些比例类的指标

* 点击数: 不变度量。
  和cookie数量类似，这个指标不依赖是否展示“开始免费试学”页面。因为他们点击之前是没有显示这个页面的

* 点击率: 不变度量。
  因为用户在点击按钮之前并没有看到这个页面， 点击率也是不依赖我们的测试内容的

* 总转化率: 是一个评估度量。   
  是否决定开始课程是依赖用户是否看见“开始免费试学”页面的。所以这是一个很好的评估指标

* 留存率: 是一个评估度量。 
  类似的，我们想要知道“是否每周有5小时以上时间”的建议是否对提高付费比例有帮助，所以这是一个很好的度量。

* 净转化率 是一个评估度量。 
  净转化率是前面两个（总转化率和留存率）计算出来的，因此这也是一个很好的度量



测量可变性
---------------------

* 计算标准差 基准表

|                   | Value  | 
| ----------------------------- |:--------:| 
| Unique cookies to view page per day       | 40000   | 
| Unique cookies to click "Start free trial" per day            | 3200   |  
| Enrollments per day                        | 660   |
| Click-through-probability on "Start free trial"               | 0.08   |
| Probability of enrolling, given click           | 0.20625   |
| Probability of payment, given enroll          | 0.53   |
| Probability of payment, given click           | 0.1093125    |


根据伯努力分布的标准差公式`std = sqrt(p * (1-p) / N)`
计算以下三个度量

### 总转化率

总转化率基准值是  `p = 0.20625` 参加测试的样本数 `N = 5000 * 0.08 = 400`
可以得出标准差 `std = sqrt(p * (1-p) / N) = 0.0202`.


### 留存率

留存率的基准值是 `p = 0.53`，参加测试的样本数 `N = 5000 * 0.08 * 0.20625 = 82.5`. 
可以得出标准差 `std = sqrt(p * (1-p) / N) = 0.0549`.

### 净转化率

净转化率基准值 `p = 0.1093125`，参加测试的样本数`N = 5000 * 0.08 = 400`.
可以得出标准差 `std = sqrt(p * (1-p) / N) = 0.0156`.


#### 作为你选择作为评估度量的每个度量，用分析法估计其标准偏差。你预期分析估计是准确的吗？也就是说，如果你有足够的时间，你会为哪个度量收集变异的经验估计？

总转化率和净转化率都是用cookie数量作为分母， 因此，转移单位等于分析单位，表明分析变异性与经验变异性相当。 因此，我们的预期分析估计是准确的。
留存率对于分析单位和转移单位都是以userid来计算，他们总是能够匹配，因此我们也会为留存率收集变异的经验估计


规模
---------------------


### 选择支持的样本数量

这里不应该使用 Bonferroni修正, 因为测试中使用的度量有较强的相关性。使用bonferroni修正可能会导致结果比较保守
根据[在线计算器](http://www.evanmiller.org/ab-testing/sample-size.html) 使用参数`alpha = 0.05`, `1 - beta = 0.2` 来计算需要多少样本数

* 总转化率. 
  基准值是 0.20625, `d_min`=0.01. 计算出结果是 25835.
  这个结果是点击了“开始免费试学”的，所以需要的总pv是 `25835 / 0.08 * 2 = 645875` 

* 留存率. 基准值是 0.53, `d_min` = 0.01. 计算出结果是 39115.
  同上， 我们需要的pv是 `39115 / 0.08 / 0.20625 * 2 = 4741212`

* 净转化率. 基准值是 0.1093125, `d_min` = 0.0075. 计算出结果是 27413. 
  我们需要的pv是 `27413 / 0.08 * 2 = 685325`

可以看出，如果使用留存率作为评估度量，需要的pv可能过大了。可能需要太多测试时间。
所以我们不使用留存率来测试，最后我们选出总转化率和净转化率作为评估度量

我们需要的pv是685325（其中较大的）


### 选择持续时间和风险暴露

我们使用70%的流量来测试， 总的用时是： `685325 / (40000 * 0.7) = 24.5` 天
在测试用时和风险暴露之间有较好的平衡

